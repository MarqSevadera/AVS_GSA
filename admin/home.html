<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/addons/datatables.min.css">
    <script src = "http://momentjs.com/downloads/moment.js"></script>
    <script src="js/table.js"></script>
    <script src="js/users_table.js"></script>
    <script src="js/locations_table.js"></script>
    <script src="js/reservations_table.js"></script>
  
    <title>Admin Home</title>
  </head>
  <body onload="checkSession()">

    
    
    <nav class="navbar navbar-custom">   </nav>
   
   <div class="wrapper">

   	<nav id="sidebar">
           <div class="sidebar-header"> 
               <h4 id="admin_name" style="text-align: center"></h4> 
               <p style="text-align:center">Admin</p>
           </div>
   		
   		<ul class="list-unstyled components">
   			<p id = "date-holder" class="text-center"></p>
   			<li>
   				<a href="#" id ="change_password"><i class="fa fa-fw fa-cog"></i>&nbsp Change Password</a>
   				
   			</li>
   			
   		
   			<li>
   				<a href="#" id="users" ><i class="fa fa-fw fa-user"></i>&nbsp Users </a>
   				
   			</li>
               
               
            <li>
                <a href="#pageSubmenu1" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle"><i class="fa fa-fw fa-book"></i>&nbsp Reservations </a>
                <ul class="collapse list-unstyled" id="pageSubmenu1">

                    <li>
                        <a href="#" id="all_reservation"><i class="fa fa-fw fa-sort-alpha-down"></i>&nbsp All</a>
                    </li>

                    <li>
                        <a href="#" id="pending_reservation"><i class="fa fa-fw fa-bell"></i>&nbsp Pending </a>
                    </li>

                    <li>
                        <a href="#" id="accepted_reservation"><i class="fa fa-fw fa-check"></i>&nbsp Accepted</a>
                    </li>

                    <li>
                        <a href="#" id="rejected_reservation"><i class="fa fa-fw fa-times"></i>&nbsp Rejected </a>
                    </li>

                    <li>
                        <a href="#" id="today_reservation"><i class="fa fa-fw fa-calendar"></i>&nbsp Today's Shipment</a>
                    </li>

                    <li>
                      <a href="#" id="shipped_reservation"><i class="fa fa-fw fa-plane"></i>&nbsp Shipped Cargo</a>
                   </li>

                   <li>
                    <a href="#" id="completed_reservation"><i class="fa fa-fw fa-check-circle"></i>&nbsp Completed Reservations</a>
                   </li>
                    
                </ul> 
            </li>

            <li>
                 <a href="#" id="locations"><i class="fa fa-fw fa-map-marker"></i>&nbsp Locations</a>
            </li>
   		</ul>
           
        <ul class="list-unstyled CTAs">
             <li>
                 <a  id="logout" href="#" class="article">Logout</a>
             </li>
         </ul>
    </nav>
       
   
   

    
        
      <div class=" card bg-dark col" style="width:100%!important">
              <h3 class="card-header table-card-header  text-light py-4"></h3>
              <div class="card-body" id="table">
                    <span id = "add_record" class="btn_add table-add mb-3 mr-2 float-right" ></span> 
                  <table id="myTable" class="text-center  table table-hover table-dark table-bordered table-striped" style="width:100%!important" >
             
                      <thead><tr><td>Dummy Heading1</td></tr></thead>
                      
                      <tbody>
                            
                      </tbody>
                  </table>
              </div>
       </div>
       
 
    
   
                    
   </div>

  <!-- Modal Add-->
  <div class="modal fade" id="modalAdd" tabindex="-1" role="dialog" aria-labelledby="modalAddLabel">
        <div class="modal-dialog" role="document"> 
          <div class="modal-content">
              <div class="modal-header text-center" style="background: #6d7fcc">
                  <h4 class="modal-title w-100 font-weight-bold text-light">Add New Location</h4>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
                <div class="modal-body mx-3">
                  <div class="md-form mb-5" style="display: inline-bl">
                    <i class="fas fa-map-marker prefix grey-text"></i>
                    <input type="text" id="input_location" class="form-control validate" placeholder="Location">
                  </div>
            
                  <div class="md-form mb-4">
                    <i class="fas fa-code  grey-text"></i>
                    <input type="text" id="input_code" class="form-control validate" placeholder="Code">
                  </div>
                </div>
                <div class="modal-footer d-flex justify-content-center">
                  <button type ="button" id="modal_button_save" class="btn btn-success" data-dismiss="modal" > Save <i class="fas fa-save ml-1"></i></button>
                </div>
          </div>
      </div>
  </div>
  <!-- End of  Modal Add-->

   <!-- Modal Delete-->
    <div class="modal fade" id="modalDelete" tabindex="-1" role="dialog" aria-labelledby="modalDeleteLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="modalDeleteTitle">Delete Record</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
                Are you sure you want to delete this record?
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
              <button type="button" class="btn btn-danger" data-dismiss="modal" id = "modal_button_delete">Delete</button>
            </div>
          </div>
        </div>
    </div>
   <!-- End of  Modal Delete-->

   <!-- Modal Info-->
   <div class="modal fade " id = "modalInfo" tablindex="-1" role="dialog" aria-labelledby="modalInfoLabel" aria-hidden="true">
      <div class="modal-dialog modal-lg" role="document"> 
          <div class="modal-content">

              <div class="modal-header text-center" style="background: #6d7fcc">
                  <h4 class="modal-title w-100 font-weight-bold text-light">Full Details</h4>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
              </div>

              <div class="modal-body mx-3">
                  <div class="mx-auto mb-3">
                    <img src="" class="img-thumbnail rounded mx-auto d-block" id="airline-logo" alt="airline-logo"/>
                  </div>

                  <div class=" card bg-success text-light col mb-3">
                      <h4 class="card-header py-4 text-center">Shipper's Info</h4>
                      <div class="card-body fluid text-sm" >

                        <div class="row mb-3">
                            <h6 class="col-lg-3 text-center">Name: </h6>
                            <h6 id="shippername-holder"class="col-lg-3  text-center"></h6>
                            <h6 class="col-lg-3 text-center">Company: </h6>
                            <h6 id="company-holder" class="col-lg-3 text-center"></h6>
                        </div>

                        <div class="row mb-3">
                            <h6 class="col-lg-3 text-center">Address: </h6>
                            <h6 id="address-holder" class="col-lg-3 text-center"></h6>
                            <h6 class="col-lg-3 text-center">Phone: </h6>
                            <h6 id="phone-holder" class="col-lg-3 text-center"></h6>

                        </div>
                      </div>
                  </div>

                  <div class=" card bg-danger text-light col mb-3">
                      <h4 class="card-header py-4 text-center">Shipment's Info</h4>
                      <div class="card-body fluid text-sm" >

        
                        <div class="row mb-3">
                            <h6 class="col-lg-3 text-center">Airline: </h6>
                            <h6 id="airline-holder"class="col-lg-3  text-center"></h6>
                            <h6 class="col-lg-3 text-center">Flight Code: </h6>
                            <h6 id="flightcode-holder" class="col-lg-3  text-center"></h6>
                        </div>

                        <div class="row mb-3">
                            <h6 class="col-lg-3 text-center">Origin: </h6>
                            <h6 id="origin-holder" class="col-lg-3 text-center"></h6>
                            <h6 class="col-lg-3 text-center">Destination: </h6>
                            <h6 id="destination-holder" class="col-lg-3 text-center"></h6>
                        </div>

                        <div class="row mb-3">
                            <h6 class="col-lg-3 text-center">Shipping Date: </h6>
                            <h6 id="shipdate-holder" class="col-lg-3 text-center"></h6>
                            <h6 class="col-lg-3 text-center">Status: </h6>
                            <h6 id="status-holder" class="col-lg-3 text-center"></h6>
                        </div>

                        <div class="row mb-3">
                            <h6 class="col-lg-3 text-center">Weight: </h6>
                            <h6 id="weight-holder" class="col-lg-3 text-center"></h6>
                            <h6 class="col-lg-3 text-center">Dimension: </h6>
                            <h6 id="dimension-holder" class="col-lg-3 text-center"></h6>
                        </div>

                        <div class="row mb-3">
                            <h6 class="col-lg-3 text-center">Pieces: </h6>
                            <h6 id="pieces-holder" class="col-lg-3 text-center"></h6>                         
                        </div>
                      </div>
                  </div>

                  <div class=" card bg-info text-light col mb-3">
                      <h4 class="card-header py-4 text-center">Consignee's Info</h4>
                      <div class="card-body fluid text-sm" >

                        <div class="row mb-3">
                            <h6 class="col-lg-3 text-center">Name: </h6>
                            <h6 id="coname-holder"class="col-lg-3  text-center"></h6>
                            <h6 class="col-lg-3 text-center">Address: </h6>
                            <h6 id="coaddress-holder" class="col-lg-3  text-center"></h6>
                        </div>

                      </div>
                  </div>

              <div class="modal-footer d-flex justify-content-center">
                <button id="modal_button_reject" class="btn btn-secondary"data-dismiss="modal" > Close <i class="fas fa-times "></i> </button>
              </div>
        
          </div>
      </div>
   </div>
  </div>
   <!--End of Modal Info-->
    
  <!-- Modal Reject-->
  <div class="modal fade" id="modalReject" tabindex="-1" role="dialog" aria-labelledby="modalRejectLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="modalRejectTitle">Reject Reservation</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
              <h4>Write additional message</h4>
              <textarea rows = "5" id="reject_message" class="form-control" placeholder="Message"></textarea>  
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
            <button type="button" class="btn btn-danger" data-dismiss="modal" id = "modal_button_confirm_rejection">Confirm Rejection</button>
          </div>
        </div>
      </div>
  </div>
  <!--End of Modal Reject-->

  <!-- Modal Accept-->
  <div class="modal fade" id="modalAccept" tabindex="-1" role="dialog" aria-labelledby="modalAcceptLabel" aria-hidden="true">
     <div class="modal-dialog modal-dialog-centered" role="document">
       <div class="modal-content">
         <div class="modal-header">
           <h5 class="modal-title" id="modalAcceptTitle">Accept Reservation</h5>
           <button type="button" class="close" data-dismiss="modal" aria-label="Close">
             <span aria-hidden="true">&times;</span>
           </button>
         </div>
         <div class="modal-body">
             <h5>Enter Flight Code</h5>
             <input type="text" id="input_flight_code" class="form-control validate" placeholder="Flight">
             <h5>Airway Billing</h5>
             <input type="text" id="input_awb" class="form-control validate" placeholder="AWB">
         </div>
         <div class="modal-footer">
           <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
           <button type="button" class="btn btn-success" data-dismiss="modal" id = "modal_button_confirm_accept">Confirm</button>
         </div>
       </div>
     </div>
 </div>
 <!--End of Modal Accept-->

  <!-- Modal Ship-->
   <div class="modal fade" id="modalShip" tabindex="-1" role="dialog" aria-labelledby="modalShipLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="modalShipTitle">Ship Reservation</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <h4>Send a message</h4>
          <textarea rows = "5" id="shipping_message" class="form-control" placeholder="Message"></textarea>  
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-success" data-dismiss="modal" id = "modal_button_ship">Ship</button>
        </div>
      </div>
    </div>
</div>
<!--End of Modal Ship-->


  <!-- Modal Send Message-->
  <div class="modal fade" id="modalSend" tabindex="-1" role="dialog" aria-labelledby="modalSendLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="modalSendTitle">Send Arrival Message</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <h4>Construct Message</h4>
          <textarea rows = "5" id="arrival_message" class="form-control" placeholder="Message"></textarea>  
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-success" data-dismiss="modal" id = "modal_button_send">Send</button>
        </div>
      </div>
    </div>
</div>
<!--End of Modal Send Message-->



<!--Modal: Change Password-->
<div class="modal fade" id="modalChangePass" tabindex="-1" role="dialog" aria-labelledby="modalChangePassLabel"
  aria-hidden="true">
  <div class="modal-dialog cascading-modal modal-avatar modal-sm" role="document">
    <!--Content-->
    <div class="modal-content">

      <!--Header-->
      <div class="modal-header">
        <img src="img/avatar.png" alt="avatar" class="rounded-circle img-responsive mx-auto d-block">
     
      </div>
    
      <!--Body-->
      <div class="modal-body text-center mb-1">

        <h5 class="mt-1 mb-2">Admin</h5>

        <div class="row mb-2">
          <div class="col-md-12 from-group">
              <input id = "oldpass" type="password" type="text" id="form29" class="form-control form-control-sm validate ml-0" placeholder="Enter Old Password">
          </div>
        </div>

        <div class="row mb-2">
          <div class="col-md-12 from-group" >
            <input  id = "newpass" type="password" type="text" id="form29" class="form-control form-control-sm validate ml-0" placeholder="Enter New Password" >
          </div>
        </div>

        <div class="row mb-2">
          <div class="col-md-12 from-group">
            <input  id = "confirmpass" type="password" type="text" id="form29" class="form-control form-control-sm validate ml-0" placeholder="Confirm Password">
          </div>
        </div>

        <div class="text-center mt-4">
          <button id="modal_button_proceed" class="btn btn-success mt-1">Proceed </button>
          <button  class="btn btn-secondary mt-1" data-dismiss="modal">Close </button>
        </div>
     
      </div>

    </div>
    <!--/.Content-->
  </div>
</div>
<!--Modal: Change Password-->


<!-- Modal Success -->
<div class="modal fade right" id="modalSuccess" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-side modal-bottom-right" role="document">
    <div class="modal-content">
      <div class="modal-header bg-success text-light">
        <h4 class="modal-title w-100" id="myModalLabel">Password Changed!</h4>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
       The administrator's password was successfully changed!
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<!-- Modal Success-->

<!-- Modal Invalid -->
<div class="modal fade right" id="modalInvalid" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
  aria-hidden="true">

  
  <div class="modal-dialog modal-side modal-bottom-right" role="document">


    <div class="modal-content">
      <div class="modal-header bg-danger text-light">
        <h4 class="modal-title w-100" id="myModalLabel">Invalid Credentials!</h4>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
       The password cant be changed because one or more input requirement is invalid.
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<!-- Modal Invalid-->


   <script src="https://www.gstatic.com/firebasejs/5.8.1/firebase.js"></script>
    <script>
    // Initialize Firebase
    var config = {
        apiKey: "AIzaSyDBiBD9k-HPq2fff1be8ZDYiTapAKuNymY",
        authDomain: "avs-gsa-e40e2.firebaseapp.com",
        databaseURL: "https://avs-gsa-e40e2.firebaseio.com",
        projectId: "avs-gsa-e40e2",
        storageBucket: "avs-gsa-e40e2.appspot.com",
        messagingSenderId: "986808775904"
    }; 
    firebase.initializeApp(config);
    </script>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="js/jquery-3.3.1.min.js"></script>
    <script src="js/popper.min.js"></script>
    <script src="js/bootstrap.min.js" ></script>
    <script src = "js/addons/datatables.min.js"></script>
    <script src="js/mdb.js"></script>

    <script>

        $(document).ready(function(){
            $('#myTable').DataTable();
            Reservations.showData("all");
        });
        
        $(document).on('click', '.btn_edit',function(event){
            event.preventDefault();
            var tbl_row = $(this).closest('tr');
            Table.makeRowEditable(tbl_row);
        
        });

        $(document).on('click', '.btn_cancel',function(event){
            event.preventDefault();
            var tbl_row = $(this).closest('tr');
            Table.disableRow(tbl_row);
          
        });


        $(document).on('click', '.btn_delete',function(event){
            event.preventDefault();
            $('#modalDelete').modal();   
            var tbl_row = $(this).closest('tr');
            var id = tbl_row.find('.bt1').attr('id');
            $('#modal_button_delete').attr('caller_id' , id);
        });


        $(document).on('click','.btn_save',function(event){
            event.preventDefault();
            var tbl_row = $(this).closest('tr');
            Locations.saveData(tbl_row);
        });

        $(document).on('click','.btn_info',function(event){
          event.preventDefault();
          var tbl_row = $(this).closest('tr');
          var id = tbl_row.find('.bt1').attr('id');
          Reservations.getReservationData(id);        
          $('#modalInfo').modal();
        });
    
        $(document).on('click','.btn_reject',function(event){
          event.preventDefault();
          var tbl_row = $(this).closest('tr');
          var id = tbl_row.find('.bt1').attr('id');
          $('#modal_button_confirm_rejection').attr('caller_id', id);
          $('#modalReject').modal();
        });
       
     
        $(document).on('click','.btn_accept',function(event){
          event.preventDefault();
          var tbl_row = $(this).closest('tr');
          var id = tbl_row.find('.bt1').attr('id');
          $('#modal_button_confirm_accept').attr('caller_id', id);
          $('#modalAccept').modal();
        });


        $(document).on('click' , '.btn_ship' , function(event){
          event.preventDefault();
          var tbl_row = $(this).closest('tr');
          var id = tbl_row.find('.bt1').attr('id');
          $('#modal_button_ship').attr('caller_id', id);
          $('#modalShip').modal();
        });


        $(document).on('click', '.btn_message',function(event){
          event.preventDefault();
          var tbl_row = $(this).closest('tr');
          var id = tbl_row.find('.bt1').attr('id');
          $('#modal_button_send').attr('caller_id', id);
          $('#modalSend').modal();
        })

        $('#change_password').click(function(){$('#modalChangePass').modal(); });
        $('#users').click(function(){Users.showData(); return false;});
        $('#locations').click(function(){Locations.showData(); return false;});
        $('#all_reservation').click(function(){Reservations.showData("all");return false;});
        $('#today_reservation').click(function(){Reservations.showData("today");return false;});
        $('#pending_reservation').click(function(){Reservations.showData("pending");return false;});
        $('#accepted_reservation').click(function(){Reservations.showData("accepted");return false;});
        $('#rejected_reservation').click(function(){Reservations.showData("rejected");return false;});
        $('#shipped_reservation').click(function(){Reservations.showData("shipped");return false;});
        $('#completed_reservation').click(function(){Reservations.showData("completed");return false;});
        $('#modal_button_delete').click(function(){var id = $(this).attr('caller_id'); Locations.deleteData(id);return false;});
        $('#modal_button_save').click(function(){var name= $('#input_location').val(); var code = $('#input_code').val(); Locations.addData(name,code);return false;});
        $('#modal_button_confirm_rejection').click(function(){ var id = $(this).attr('caller_id'); var message = $('#reject_message').val(); Reservations.reject(id,message);return false});
        $('#modal_button_confirm_accept').click(function(){ var id = $(this).attr('caller_id'); var code = $('#input_flight_code').val(); var awb = $('#input_awb').val(); Reservations.accept(id,code,awb);return false});
        $('#modal_button_proceed').click(function(){changePass();return false;});
        $('#modal_button_send').click(function(){var id= $(this).attr('caller_id'); var message = $('#arrival_message').val(); Reservations.sendMessage(id,message);return false;})
        $('#modal_button_ship').click(function(){var id = $(this).attr('caller_id'); var message = $('#shipping_message').val(); Reservations.shipCargo(id, message); return false;})
        $('#logout').click(function(){sessionStorage.clear();window.location = "index.html";});


	</script>
    
  </body>
</html>